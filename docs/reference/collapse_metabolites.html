<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Collapse Metabolites — collapse_metabolites • claman</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Collapse Metabolites — collapse_metabolites" />
<meta property="og:description" content="Combine multiple measurements of the same metabolite into a consensus
  to simplify result's presentation and pathway analysis." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">claman</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/NPLUG.html">NPLUG</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Collapse Metabolites</h1>
    
    <div class="hidden name"><code>collapse_metabolites.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Combine multiple measurements of the same metabolite into a consensus
  to simplify result's presentation and pathway analysis.</p>
    </div>

    <pre class="usage"><span class='fu'>collapse_metabolites</span><span class='op'>(</span>
  <span class='va'>mzroll_list</span>,
  preserve_distinct_methods <span class='op'>=</span> <span class='cn'>FALSE</span>,
  preserve_adducts <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mzroll_list</th>
      <td><p>output of <a href='process_mzroll.html'>process_mzroll</a> or
  <a href='process_mzroll_multi.html'>process_mzroll_multi</a></p>
<ul>
<li><p>features: one row per unique analyte (defined by a
    unique groupId),</p></li>
<li><p>samples: one row per unique sample (defined by a unique sampleId),</p></li>
<li><p>measurements: one row per peak (samples x peakgroups)</p></li>
</ul></td>
    </tr>
    <tr>
      <th>preserve_distinct_methods</th>
      <td><p>if TRUE then collapse metabolites
for each method separately. If FALSE, collapse over methods.</p></td>
    </tr>
    <tr>
      <th>preserve_adducts</th>
      <td><p>if TRUE then different ions of the same
metabolite will not be collapsed.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an mzroll_list</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Analytes are first aggregated by retaining the maximum
  intensity peak on a sample-by-sample basis over peakgroups of the
  same ion (i.e., same compoundName and adductName). This is meant to
  deal with peakgroup splitting. Once measurements are reduced to
  unique ions, ions can be further aggregated to metabolites by
  taking the median quant value on a sample-by-sample basis while
  preserving either adducts or methods.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>collapse_metabolites</span><span class='op'>(</span><span class='va'>nplug_mzroll_augmented</span><span class='op'>)</span>
</div><div class='output co'>#&gt; $features
#&gt; <span style='color: #949494;'># A tibble: 106 × 10</span>
#&gt;    groupId compoundName  smiles tagString    mz    rt compoundDB searchTableName
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>  <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>      <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>          
#&gt; <span style='color: #BCBCBC;'> 1</span> 1       Ribose-P      <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 2</span> 2       OMP           <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 3</span> 3       1,3-diphopsh… <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 4</span> 4       3-hydroxy-3-… <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 5</span> 5       3-phosphogly… <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 6</span> 6       6-phospho-D-… <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 7</span> 7       acetyl-CoA    <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 8</span> 8       aconitate     <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'> 9</span> 9       adenosine     <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #BCBCBC;'>10</span> 10      ADP           <span style='color: #BB0000;'>NA</span>     <span style='color: #949494;'>""</span>           <span style='color: #BB0000;'>NA</span>    <span style='color: #BB0000;'>NA</span> <span style='color: #BB0000;'>NA</span>         <span style='color: #BB0000;'>NA</span>             
#&gt; <span style='color: #949494;'># … with 96 more rows, and 2 more variables: label &lt;chr&gt;, pathway &lt;chr&gt;</span>
#&gt; 
#&gt; $samples
#&gt; <span style='color: #949494;'># A tibble: 136 × 13</span>
#&gt;    sampleId name     filename samples_tbl_row sample_name  month replicate    DR
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>              <span style='color: #949494; font-style: italic;'>&lt;int&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>        <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> 1        NH4_0.0… <span style='color: #BB0000;'>NA</span>                     1 NH4_0.055_f… Jun   B         0.055
#&gt; <span style='color: #BCBCBC;'> 2</span> 2        NH4_0.0… <span style='color: #BB0000;'>NA</span>                     2 NH4_0.055_f… Jun   D         0.055
#&gt; <span style='color: #BCBCBC;'> 3</span> 3        NH4_0.0… <span style='color: #BB0000;'>NA</span>                     3 NH4_0.055_p… Jun   A         0.055
#&gt; <span style='color: #BCBCBC;'> 4</span> 4        NH4_0.0… <span style='color: #BB0000;'>NA</span>                     4 NH4_0.055_p… Jun   C         0.055
#&gt; <span style='color: #BCBCBC;'> 5</span> 5        NH4_0.1… <span style='color: #BB0000;'>NA</span>                     5 NH4_0.173_f… Jun   B         0.173
#&gt; <span style='color: #BCBCBC;'> 6</span> 6        NH4_0.1… <span style='color: #BB0000;'>NA</span>                     6 NH4_0.173_f… Jun   D         0.173
#&gt; <span style='color: #BCBCBC;'> 7</span> 7        NH4_0.1… <span style='color: #BB0000;'>NA</span>                     7 NH4_0.173_p… Jun   A         0.173
#&gt; <span style='color: #BCBCBC;'> 8</span> 8        NH4_0.1… <span style='color: #BB0000;'>NA</span>                     8 NH4_0.173_p… Jun   C         0.173
#&gt; <span style='color: #BCBCBC;'> 9</span> 9        NH4_0.2… <span style='color: #BB0000;'>NA</span>                     9 NH4_0.210_f… Jun   B         0.21 
#&gt; <span style='color: #BCBCBC;'>10</span> 10       NH4_0.2… <span style='color: #BB0000;'>NA</span>                    10 NH4_0.210_f… Jun   D         0.21 
#&gt; <span style='color: #949494;'># … with 126 more rows, and 5 more variables: limitation &lt;chr&gt;, exp_ref &lt;chr&gt;,</span>
#&gt; <span style='color: #949494;'>#   extraction &lt;chr&gt;, condition &lt;int&gt;, reference &lt;int&gt;</span>
#&gt; 
#&gt; $measurements
#&gt; <span style='color: #949494;'># A tibble: 14,416 × 4</span>
#&gt;    groupId sampleId log2_abundance centered_log2_abundance
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>   <span style='color: #949494; font-style: italic;'>&lt;fct&gt;</span>             <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>                   <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'> 1</span> 1       1                  15.1                    1.21
#&gt; <span style='color: #BCBCBC;'> 2</span> 1       2                  14.9                    1.07
#&gt; <span style='color: #BCBCBC;'> 3</span> 1       3                  15.4                    1.55
#&gt; <span style='color: #BCBCBC;'> 4</span> 1       4                  15.5                    1.59
#&gt; <span style='color: #BCBCBC;'> 5</span> 1       5                  15.4                    1.49
#&gt; <span style='color: #BCBCBC;'> 6</span> 1       6                  15.6                    1.76
#&gt; <span style='color: #BCBCBC;'> 7</span> 1       7                  16.0                    2.13
#&gt; <span style='color: #BCBCBC;'> 8</span> 1       8                  16.0                    2.09
#&gt; <span style='color: #BCBCBC;'> 9</span> 1       9                  15.4                    1.58
#&gt; <span style='color: #BCBCBC;'>10</span> 1       10                 15.5                    1.65
#&gt; <span style='color: #949494;'># … with 14,406 more rows</span>
#&gt; 
#&gt; $design
#&gt; $design$features
#&gt; <span style='color: #949494;'># A tibble: 10 × 2</span>
#&gt;    variable        type               
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>           <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>              
#&gt; <span style='color: #BCBCBC;'> 1</span> groupId         feature_primary_key
#&gt; <span style='color: #BCBCBC;'> 2</span> compoundName    character          
#&gt; <span style='color: #BCBCBC;'> 3</span> smiles          character          
#&gt; <span style='color: #BCBCBC;'> 4</span> tagString       character          
#&gt; <span style='color: #BCBCBC;'> 5</span> mz              numeric            
#&gt; <span style='color: #BCBCBC;'> 6</span> rt              numeric            
#&gt; <span style='color: #BCBCBC;'> 7</span> compoundDB      character          
#&gt; <span style='color: #BCBCBC;'> 8</span> searchTableName character          
#&gt; <span style='color: #BCBCBC;'> 9</span> label           character          
#&gt; <span style='color: #BCBCBC;'>10</span> pathway         character          
#&gt; 
#&gt; $design$samples
#&gt; <span style='color: #949494;'># A tibble: 13 × 2</span>
#&gt;    variable        type              
#&gt;    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>           <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>             
#&gt; <span style='color: #BCBCBC;'> 1</span> sampleId        sample_primary_key
#&gt; <span style='color: #BCBCBC;'> 2</span> name            character         
#&gt; <span style='color: #BCBCBC;'> 3</span> filename        character         
#&gt; <span style='color: #BCBCBC;'> 4</span> samples_tbl_row integer           
#&gt; <span style='color: #BCBCBC;'> 5</span> sample_name     character         
#&gt; <span style='color: #BCBCBC;'> 6</span> month           character         
#&gt; <span style='color: #BCBCBC;'> 7</span> replicate       character         
#&gt; <span style='color: #BCBCBC;'> 8</span> DR              numeric           
#&gt; <span style='color: #BCBCBC;'> 9</span> limitation      character         
#&gt; <span style='color: #BCBCBC;'>10</span> exp_ref         character         
#&gt; <span style='color: #BCBCBC;'>11</span> extraction      character         
#&gt; <span style='color: #BCBCBC;'>12</span> condition       integer           
#&gt; <span style='color: #BCBCBC;'>13</span> reference       integer           
#&gt; 
#&gt; $design$measurements
#&gt; <span style='color: #949494;'># A tibble: 4 × 2</span>
#&gt;   variable                type               
#&gt;   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>                   <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>              
#&gt; <span style='color: #BCBCBC;'>1</span> groupId                 feature_primary_key
#&gt; <span style='color: #BCBCBC;'>2</span> sampleId                sample_primary_key 
#&gt; <span style='color: #BCBCBC;'>3</span> log2_abundance          numeric            
#&gt; <span style='color: #BCBCBC;'>4</span> centered_log2_abundance numeric            
#&gt; 
#&gt; $design$feature_pk
#&gt; [1] "groupId"
#&gt; 
#&gt; $design$sample_pk
#&gt; [1] "sampleId"
#&gt; 
#&gt; 
#&gt; attr(,"class")
#&gt; [1] "triple_omic" "tomic"       "mzroll"     </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sean Hackett, Phil Seitzer, Calico Life Sciences LLC.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


